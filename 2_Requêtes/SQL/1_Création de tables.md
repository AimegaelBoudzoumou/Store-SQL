# Création de tables - CREATE


--------------------------------  Tout les codes de "création de tables" en un seul bloc ------------------------------------------------------------

```sql
--marques (nom_marque, date_creation_marque, #matricule_employe_etre_acheteur, #matricule_employe_etre_chef_de_produit)

DROP TABLE marques CASCADE CONSTRAINTS;
CREATE TABLE marques (
    idValue NUMBER GENERATED BY DEFAULT AS IDENTITY,
    nom_marque VARCHAR2(255) NOT NULL,
    date_creation_marque DATE NOT NULL,
    matricule_employe_etre_acheteur VARCHAR2(255) NULL,       -- L'acheteur(se) sera affecté plus tard sur le produit en cours de création.
    matricule_employe_etre_chef_de_produit VARCHAR2(255) NULL,
    PRIMARY KEY (nom_marque)                                  -- L'idéal aurait été de faire en sorte que la clé primaire soit un INT et non un VARCHAR
);

--gammes (nom_gamme, date_creation_gamme, #nom_marque)
DROP TABLE gammes CASCADE CONSTRAINTS;
CREATE TABLE gammes (
    idValue NUMBER GENERATED BY DEFAULT AS IDENTITY,
    nom_gammes VARCHAR2(255) NOT NULL,
    date_creation_gamme DATE NOT NULL,
    nom_marque VARCHAR2(255) NOT NULL -- Une gamme est obligatoirement liées à une marque
);
ALTER TABLE gammes ADD CONSTRAINT FK_gammes_nom_marque FOREIGN KEY (nom_marque) REFERENCES marques (nom_marque);

--categories (nom_categorie, date_creation_categorie)
DROP TABLE categories CASCADE CONSTRAINTS;
CREATE TABLE categories (
    idValue NUMBER GENERATED BY DEFAULT AS IDENTITY,
    nom_categorie VARCHAR2(255) NOT NULL,
    date_creation_categorie DATE NOT NULL,
    PRIMARY KEY (nom_categorie)
);

--phases (nom_phase, signification)
DROP TABLE phases CASCADE CONSTRAINTS;
CREATE TABLE phases (
	idValue NUMBER GENERATED BY DEFAULT AS IDENTITY,
    nom_phase VARCHAR2(255) NOT NULL,
    signification VARCHAR2(255) NULL,
    PRIMARY KEY (nom_phase)
);

--types_de_produit (nom_type)
DROP TABLE types_de_produit CASCADE CONSTRAINTS;
CREATE TABLE types_de_produit (
	idValue NUMBER GENERATED BY DEFAULT AS IDENTITY,
    nom_type VARCHAR(255) NOT NULL,
    PRIMARY KEY (nom_type)
);

--employes (matricule_employe, nom_employe, prenom_employe, full_name_employe)
DROP TABLE employes CASCADE CONSTRAINTS;
CREATE TABLE employes (
    idValue NUMBER GENERATED BY DEFAULT AS IDENTITY,
    matricule_employe VARCHAR2(255) NOT NULL, 
    nom_employe VARCHAR2(100) NOT NULL, 
    prenom_employe VARCHAR2(100) NOT NULL,
    full_name_employe VARCHAR2(255) GENERATED ALWAYS AS (
    	prenom_employe || ' ' || nom_employe    
    ),
    PRIMARY KEY(matricule_employe)
);

--produits (reference_fabricant, reference_interne, date_creation_produit, date_derniere_commande, visibilite_web, titre, designation, description_produit, quantite_globale, filtre_gamme, filtre_categorie, #nom_phase, #nom_type, #nom_categorie, #nom_gamme)
-- titre sera de la forme « Fabricant_Marque - Gamme Référence_fabricant »
DROP TABLE produits CASCADE CONSTRAINTS;
CREATE TABLE produits (
    idValue NUMBER GENERATED BY DEFAULT AS IDENTITY,
    reference_fabricant VARCHAR2(255) NOT NULL, 
    reference_interne INT NOT NULL -- floor(dbms_random.value(7000000, 7999999))
    date_creation_produit DATE NOT NULL, -- Très important, par exemple pour savoir le nombre de produits créés à une période données
    date_derniere_commande DATE NULL, 
    visibilite_web VARCHAR2(10) NOT NULL -- par défaut à : non
    titre VARCHAR2(255) GENERATED ALWAYS AS (
    	nom_gamme.nom_marque || ' - ' || nom_gamme || ' ' || reference_fabricant -- titre est de la forme « Fabricant_Marque - Gamme Référence_fabricant »    
    ),
    designation VARCHAR2(255) NULL, 
    description_produit VARCHAR2(255) NULL, 
    quantite_globale INT NOT NULL, -- sera de la forme -- floor(dbms_random.value(0, 500)) -- Le choix de l'intervalle 0 à 500 est aléatoire
    filtre_gamme CHAR, -- soit "1" (pour présence d'un filtre gamme), soit "0" (pour absence d'un filtre gamme)
    filtre_categorie CHAR, -- soit "1" (pour présence d'un filtre categorie), soit "0" (pour absence d'un filtre categorie)
    nom_phase VARCHAR2(255) NOT NULL, -- par défaut à ...consulter la documentation officielle dans TMS
    nom_type VARCHAR(255) NOT NULL,
    nom_categorie VARCHAR2(255) NOT NULL,
    nom_gamme VARCHAR2(255) NOT NULL
);
-- ALTER TABLE produits
ALTER TABLE produits ADD CONSTRAINTS FK_produits_nom_phase FOREIGN KEY (nom_phase) REFERENCES phases (nom_phase);
ALTER TABLE produits ADD CONSTRAINTS FK_produits_nom_type FOREIGN KEY (nom_type) REFERENCES phases (nom_phase);
ALTER TABLE produits ADD CONSTRAINTS FK_produits_nom_categorie FOREIGN KEY (nom_categorie) REFERENCES categories (nom_categorie);
ALTER TABLE produits ADD CONSTRAINTS FK_produits_nom_gamme FOREIGN KEY (nom_gamme) REFERENCES gammes (nom_gamme);

--bundles (numero, date_creation_bundle)
DOP TABLE bundles CASCADE CONSTRAINTS;
CREATE TABLE bundles (
    idValue NUMBER GENERATED BY DEFAULT AS IDENTITY,
    numero INT NOT NULL,
    date_creation_bundle DATE, -- 
    PRIMARY KEY (numero)    
);

--bundle_produits (reference_fabricant, numero)
DROP TABLE bundles_produits CASCADE CONSTRAINTS;
CREATE TABLE bundle_produits (
    idValue NUMBER GENERATED BY DEFAULT AS IDENTITY,
    reference_fabricant INT NOT NULL,
    numero INT NOT NULL,
    PRIMARY KEY (reference_fabricant,numero)
);
ALTER TABLE bundle_produits ADD CONSTRAINTS FK_bundles_produits_reference_fabricant FOREIGN KEY (reference_fabricant) REFERENCES produits (reference_fabricant);
ALTER TABLE bundle_produits ADD CONSTRAINTS FK_bundles_produits_numero FOREIGN KEY (numero) REFERENCES bundles (numero);


--------------------------------------------------
-- TO_DATE('2023-12-03', 'YY-MM-DD')
-- TO_CHAR(date_creation_produit, 'DD/MM/YYYY') as date_crea
-- SELECT TO_CHAR (SYSDATE, 'DD/MM/YYYY HH24:MI:SS') "NOW" FROM DUAL;
```
